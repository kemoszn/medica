{% extends 'base.html' %}
{% load mathfilters %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<br>
<h3>&nbsp;{{ profile.name }}</h3>
<hr>
<div class="row">
          <div class="col-lg-3 col-6">
            <!-- small box -->
            <div class="small-box bg-warning">
              <div class="inner">
                <h3>{{ update.confirmed }}</h3>

                <p>Confirmed Cases</p>
              </div>
              <div class="icon">
                <i class="ion ion-person-add"></i>
              </div>
            </div>
          </div>
          <!-- ./col -->
          <div class="col-lg-3 col-6">
            <!-- small box -->
            <div class="small-box bg-success">
              <div class="inner">
                <h3>{{ update.pui }}</h3>

                <p>Person Under Investigation (PUI)</p>
              </div>
              <div class="icon">
                <i class="ion"><ion-icon name="people"></ion-icon></i>
              </div>
            </div>
          </div>
          <!-- ./col -->
          <div class="col-lg-3 col-6">
            <!-- small box -->
            <div class="small-box bg-info">
              <div class="inner">
                <h3>{{ update.acute_care }}</h3>

                <p>Available Acute Care Units</p>
              </div>
              <div class="icon">
                <i class="ion"><ion-icon name="bed"></ion-icon></i>
              </div>
            </div>
          </div>
          <!-- ./col -->
          <div class="col-lg-3 col-6">
            <!-- small box -->
            <div class="small-box bg-danger">
              <div class="inner">
                <h3>{{ update.icu }}</h3>

                <p>Available ICU Units</p>
              </div>
              <div class="icon">
                <i class="ion"><ion-icon name="bed"></ion-icon></i>
              </div>
              
            </div>
          </div>
          <!-- ./col -->
        </div>
<div class="row">
          <div class="col-lg-3 col-6">
            <!-- small box -->
            <div class="small-box bg" style="background-color: #343a40; color: white;">
              <div class="inner">
                <h3>{{ update.masks }}</h3>

                <p>Available Masks</p>
              </div>
              <div class="icon">
                <i class="ion ion-bag"></i>
              </div>
            </div>
          </div>
          <div class="col-lg-3 col-6">
            <!-- small box -->
            <div class="small-box bg" style="background-color: orange; color: white;">
              <div class="inner">
                <h3>{{ update.ventilators }}</h3>

                <p>Available Ventilators</p>
              </div>
              <div class="icon">
                <i class="ion"><i class="fa fa-plus-square" aria-hidden="true"></i>
</i>
              </div>
            </div>
          </div>
          <div class="col-lg-3 col-6">
            <!-- small box -->
            <div class="small-box bg" style="background-color: purple; color: white;">
              <div class="inner">
                <h3>{{ update.respirators }}</h3>

                <p>Available Respirators</p>
              </div>
              <div class="icon">
                <i class="ion"><i class="fa fa-medkit" aria-hidden="true"></i>
</i>
              </div>
            </div>
          </div>
          <div class="col-lg-3 col-6">
            <!-- small box -->
            <div class="small-box bg" style="background-color: cyan; color: black;">
              <div class="inner">
                <h3>{{ update.gloves }}</h3>

                <p>Available Gloves </p>
              </div>
              <div class="icon">
                <i class="ion"><ion-icon name="hand-right"></ion-icon></i>
              </div>
            </div>
          </div>

</div>
<div class="container-fluid">
<div class="row">
          <div class="col-md-12">
            <div class="card">
              <div class="card-header">
                <h5 class="card-title">Monthly Recap Report</h5>

                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="collapse">
                    <i class="fas fa-minus"></i>
                  </button>
                
                </div>
              </div>
              <!-- /.card-header -->
              <div class="card-body">
                <div class="row">
                  <div class="col-md-8">
                    <p class="text-center">
                      <strong>Confirmed and PUI Cases</strong>
                    </p>

                    <div class="chart" style="float: center;">
                      <!-- Sales Chart Canvas -->
                       <div style="width:100%;">
		<canvas id="canvas" height="100" style="-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none; height: 100px;"></canvas>
	</div>
                    </div>
                    <!-- /.chart-responsive -->
                  </div>
                  <!-- /.col -->
                  <div class="col-md-4">
                    <p class="text-center">
                      <strong>Medical Resources Usage</strong>
                    </p>

                    <div class="progress-group">
                      Acute Care Units
                      <span class="float-right"><b>{{ update.acute_care }}</b>/{{ update.acute_care_total }}</span>
                      <div class="progress progress-sm">
                        <div class="progress-bar bg-info"
                         style="width: {{ update.acute_care|div:update.acute_care_total|mul:100 }}%"></div>
                      </div>
                    </div>
                    <!-- /.progress-group -->

                    <div class="progress-group">
                      ICU Units 
                      <span class="float-right"><b>{{ update.icu }}</b>/{{ update.icu_total }}</span>
                      <div class="progress progress-sm">
                        <div class="progress-bar bg-danger"
                         style="width: {{ update.icu|div:update.icu_total|mul:100 }}%"></div>
                      </div>
                    </div>

                    <!-- /.progress-group -->
                    <div class="progress-group">
                      <span class="progress-text">Masks</span>
                      <span class="float-right"><b>{{ update.masks }}</b>/{{ update.masks_total }}</span>
                      <div class="progress progress-sm">
                        <div class="progress-bar bg"
                         style="background-color: #343a40; width: {{ update.masks|div:update.masks_total|mul:100 }}%"></div>
                      </div>
                    </div>

                    <!-- /.progress-group -->
                    <div class="progress-group">
                      Ventilators
                      <span class="float-right"><b>{{ update.ventilators }}</b>/{{ update.ventilators_total }}</span>
                      <div class="progress progress-sm">
                        <div class="progress-bar bg" 
                        style="background-color: orange; width: {{ update.ventilators|div:update.ventilators_total|mul:100 }}%"></div>
                      </div>
                    </div>
                    <!-- /.progress-group -->

                    <!-- /.progress-group -->
                    <div class="progress-group">
                      Respirators 
                      <span class="float-right"><b>{{ update.respirators }}</b>/{{ update.respirators_total }}</span>
                      <div class="progress progress-sm">
                        <div class="progress-bar bg"
                         style="background-color: purple; width: {{ update.respirators|div:update.respirators_total|mul:100 }}%"></div>
                      </div>
                    </div>
                    <!-- /.progress-group -->
                    <div class="progress-group">
                      Gloves
                      <span class="float-right"><b>{{ update.gloves }}</b>/{{ update.gloves_total }}</span>
                      <div class="progress progress-sm">
                        <div class="progress-bar bg" 
                        style="background-color: cyan; width: {{ update.gloves|div:update.gloves_total|mul:100 }}%"></div>
                      </div>
                    </div>
                    <!-- /.progress-group -->
                   

                  </div>
                  <!-- /.col -->
                </div>
                <!-- /.row -->
              </div>
</div>
        <!-- updates -->
<br><br>

 <div class="row">
          <div class="col-12">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Hospital's Medical Log</h3>
                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="collapse">
                    <i class="fas fa-minus"></i>
                  </button>
                </div>
              </div>
              <!-- /.card-header -->
              <div class="card-body table-responsive p-0">
                <table class="table table-hover text-nowrap">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Confirmed Cases</th>
                      <th>Person Under Investigation (PUI)</th>
                      <th>Acute Care Units</th>
                      <th>ICU</th>
                      <th>Ventilators</th>
                      <th>Masks </th>
                      <th>Gloves </th>
                      <th>Respirators </th>
                    </tr>
                  </thead>
                  <tbody>
                  {% for i in updates %}
                    <tr>
                      <td>{{ i.created }}</td>
                      <td>{{ i.confirmed }}</td>
                      <td>{{ i.pui }}</td>
                      <td><span class="tag tag-success">{{ i.acute_care }}</span></td>
                      <td>{{ i.icu }}</td>
                      <td>{{ i.ventilators }}</td>
                      <td>{{ i.masks }}</td>
                      <td>{{ i.gloves }}</td>
                      <td>{{ i.respirators }}</td>
                    </tr>
                  {% endfor %}
                  </tbody>
                </table>
              </div>
              <!-- /.card-body -->
            </div>
            <!-- /.card -->
          </div>
        </div>
        <!-- /.row -->
        <!-- ./updates -->

{% endblock %}
{% block jscript %}
		var lineChartData = {
			labels: {{ labels|safe }},
			datasets: [{
				label: 'Confirmed Cases',
				borderColor: window.chartColors.red,
				backgroundColor: window.chartColors.red,
				fill: false,
				data: {{ data|safe }},
				yAxisID: 'y-axis-1',
			}, {
				label: 'Persons Under Investigation (PUI)',
				borderColor: window.chartColors.blue,
				backgroundColor: window.chartColors.blue,
				fill: false,
				data: {{ data_1|safe }},
				yAxisID: 'y-axis-2'
			}]
		};

		window.onload = function() {
			var ctx = document.getElementById('canvas').getContext('2d');
			window.myLine = Chart.Line(ctx, {
				data: lineChartData,
				options: {
					responsive: true,
					hoverMode: 'index',
					stacked: false,
					title: {
						display: false,
						text: 'Chart.js Line Chart - Multi Axis'
					},
					scales: {
						yAxes: [{
							type: 'linear', // only linear but allow scale type registration. This allows extensions to exist solely for log scale for instance
							display: true,
							position: 'left',
							id: 'y-axis-1',
						}, {
							type: 'linear', // only linear but allow scale type registration. This allows extensions to exist solely for log scale for instance
							display: true,
							position: 'right',
							id: 'y-axis-2',

							// grid line settings
							gridLines: {
								drawOnChartArea: false, // only want the grid lines for one axis to show up
							},
						}],
					}
				}
			});
		};

		document.getElementById('randomizeData').addEventListener('click', function() {
			lineChartData.datasets.forEach(function(dataset) {
				dataset.data = dataset.data.map(function() {
					return randomScalingFactor();
				});
			});

			window.myLine.update();
      console.log("success");
		});
{% endblock %}